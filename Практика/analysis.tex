\chapter{Аналитическая часть}

\section{Анализ алгоритмов удаления невидимых линий и поверхностей}

\subsection{Алгоритм обратной трассировки}

Алгоритм обратной трассировки лучей отслеживает лучи в обратном направлении (от наблюдателя к объекту). Считается, что наблюдатель расположен на положительной полуоси z в бесконечности, поэтому все световые лучи параллельны оси z. В ходе работы испускаются лучи от наблюдателя и ищутся пересечения луча и всех объектов сцены.
В результате, пересечение с максимальным значением z является видимой частью поверхности, и атрибуты данного объекта используются для определения характеристик пикселя, через центр которого проходит данный световой луч. 

Эффективность процедуры определения пересечений луча с поверхностью объекта оказывает самое большое влияние на эффективность всего алгоритма. Чтобы избавиться от ненужного поиска пересечений было придумано искать пересечение луча с объемной оболочкой рассматриваемого объекта. Под оболочкой понимается некоторый простой объект, внутрь которого можно поместить рассматриваемый объект, к примеру параллелепипед или сферу. 

В дальнейшем при рассмотрении пересечения луча и объемной оболочкой рассматриваемого объекта, если такого пересечения нет, то и соответственно пересечения луча и самого рассматриваемого объекта нет, и наоборот, пересечение найдено, то возможно, есть пересечение луча и рассматриваемого объекта. 

Для расчета эффектов освещения сцены проводятся вторичные лучи от точек пересечения ко всем источникам света. Если на пути этих лучей встречается непрозрачное тело, значит данная точка находится в тени, иначе он влияет на освещение данной точки. Также для получения более реалистичного изображения сцены, нужно учитывать вклады отраженных и преломленных лучей.

Плюсы:

\begin{itemize}
	\item возможность использования алгоритма в параллельных вычислительных системах.
\end{itemize}

Минусы:

\begin{itemize}
	\item производительность алгоритма.
\end{itemize}

\subsection{Алгоритм Робертса}

Алгоритм Робертса работает в объектном пространстве, кроме того работает только с выпуклыми телами. Если тело изначально является не выпуклым, то нужно его разбить на выпуклые составляющие.

Данный алгоритм состоит из следующих основных этапов:

\begin{itemize}
	\item подготовка исходных данных;
	\item удаление линий, экранируемых самим телом;
	\item удаление линий, экранируемых другими телами.
\end{itemize}

Плюсы:

\begin{itemize}
	\item высокая точность вычислений.
\end{itemize}

Минусы:

\begin{itemize}
	\item рост числа трудоемкости алгоритма, как квадрата числа объектов;
	\item работа только с выпуклыми телами.
\end{itemize}

\subsection{Алгоритм, использующий Z-буфер}

Алгоритм Z-буфера решает задачу в пространстве изображений. 

В данном алгоритме рассматривается два буфера. Буфер кадра (регенерации) используется для заполнения атрибутов (интенсивности) каждого пикселя в пространстве изображения. В Z-буфер (буфер глубины) можно помещать информацию о координате z для каждого пикселя.

Для начала необходимо подготовить буферы. Для этого в Z-буфер заносятся максимально возможные значения z, а буфер кадра заполняется значениями пикселя, который описывает фон. Также нужно каждый многоугольник преобразовать в растровую форму и записать в буфер кадра. Сам процесс работы заключается в сравнении глубины каждого нового пикселя, который нужно занести в буфер кадра,
с глубиной того пикселя, который уже занесён в Z-буфер. В зависимости от сравнения принимается решение, нужно ли заносить новый пиксель в буфер кадра и, если нужно, также корректируется Z-буфер (в него нужно занести глубину нового пикселя).

Плюсы:
\begin{itemize}
	\item элементы сцены заносятся в буфер кадра в произвольном порядке, поэтому в данном алгоритме не тратится время на выполнение сортировок;
	\item произвольная сложность сцены;
	\item поскольку размеры изображения ограничены размером экрана дисплея, трудоемкость алгоритма зависит линейно от числа рассматриваемых поверхностей.
\end{itemize}

Минусы:
\begin{itemize}
	\item трудоемкость устранения лестничного эффекта;
	\item трудности реализации эффектов прозрачности;
	\item большой объем требуемой памяти.
\end{itemize}

\subsection*{Вывод}

Для удаления невидимых линий и поверхностей выбран алгоритм Z-буфера, так как обладает важными преимуществами - высокой скоростью работы и произвольной сложностью сцены.


\section{Анализ методов закрашивания}

Методы закрашивания используются для затенения полигонов (или по-
верхностей, аппроксимированных полигонами) в условиях некоторой сцены, имеющей источники освещения.

\subsection{Простая закраска}

Одной из самых простых моделей освещения является модель Ламберта. Она учитывает только идеальное диффузное отражение света от тела. Считается, что свет падающий в точку, одинаково рассеивается по всем направлениям полупространства. Таким образом, освещенность в точке определяется только плотностью света в точке поверхности, а она линейно зависит от косинуса угла падения. При этом положение наблюдателя не имеет значение, т.к. диффузно отраженный свет рассеивается равномерно по всем направлениям.

Большим недостатком данной модели является то, что согласно приведённой выше формуле, все точки грани будут иметь одинаковую интенсивность.

\subsection{Закраска по Гуро}

Данный алгоритм предполагает следующие шаги:

\begin{itemize}
	\item вычисление векторов нормалей к каждой грани;
	\item вычисление векторов нормали к каждой вершине грани путем усреднения нормалей к граням;
	\item вычисление интенсивности в вершинах грани;
	\item интерполяция интенсивности вдоль ребер грани;
	\item линейная интерполяция интенсивности вдоль сканирующей строки.
\end{itemize}

Плюсы:

\begin{itemize}
	\item хорошо сочетается с диффузным отражением;
	\item изображение получается более реалистичным.
\end{itemize}

Минусы:

\begin{itemize}
	\item данный метод интерполяции обеспечивает лишь непрерывность значений интенсивности вдоль границ многоугольников, но не обеспечивает непрерывность изменения интенсивности.
\end{itemize}


\subsection{Закраска по Фонгу}

При такой закраске, в отличие от метода Гуро, вдоль сканирующей строки интерполируется значение вектора нормали, а не интенсивности. 

Шаги алгоритма:

\begin{itemize}
	\item вычисление векторов нормалей в каждой грани.
	\item вычисление векторов нормали к каждой вершине грани.
	\item интерполяция векторов нормалей вдоль ребер грани.
	\item линейная интерполяция векторов нормалей вдоль сканирующей строки.
	\item вычисление интенсивности в очередной точке сканирующей строки.
\end{itemize}

Плюсы:

\begin{itemize}
	\item можно достичь лучшей локальной аппроксимации кривизны поверхности.
\end{itemize}

Минусы:

\begin{itemize}
	\item ресурсоемкость;
	\item вычислительная сложность.
\end{itemize}

\subsection*{Вывод}

Для закрашивания выбран алгоритм Гуро, так как данный алгоритм обладает важным преимуществом - высокой реалистичностью изображения.

\section*{Вывод}

В данном разделе были формально описаны алгоритмы удаления невидимых линий и поверхностей, методы закрашивания поверхностей. В качестве алгоритма удаления невидимых линий и поверхностей был выбран алгоритм Z-буфера, в качестве метода закрашивания был выбран алгоритм закраски Гуро.

\section{Понятие броуновского движения}

\textbf{Броуновское движение} (иногда называют Брауновское движение) -- беспорядочное движение малых частиц, взвешенных в жидкости или газе, происходящее под действием молекул окружающей среды. Исследовано в 1827 г. Броуном (Браун; Brown), который наблюдал в микроскоп движение цветочной пыльцы, взвешенной в воде. 

\imgHeight{60mm}{brown_movement.png}{Броуновское движение}

Частицы размером около 1 мкм и менее совершают неупорядоченные независимые движения, описывая сложные зигзагообразные траектории. Интенсивность броуновского движения не зависит от времени, но возрастает с увеличением температуры, уменьшением вязкости и размеров частиц (независимо от их химической природы.)

Теория броуновского движения была построена независимо друг от друга Эйнштейном и Смолуховским в 1905-1906 гг. Причиной броуновского движения является тепловое движение молекул среды, проявляющееся в некомпенсированных ударах молекул о частицу, т.е. в флуктуациях давления. Эти удары приводят частицу в беспорядочное движение. Если отмечать положения частицы через равные небольшие промежутки времени, то траектория окажется сложной и запутанной.

Как показывают опытные данные, квадрат смещения частицы из начального положения в проекции на любую ось $ \langle x^2 \rangle $ за время наблюдения $\tau$, в отсутствие внешних сил определяется выражением $  \langle x^2 \rangle $ = 2D$\tau$, где коэффициент диффузии броуновской (сферической) частицы D = $\frac{\textit{k}T}{6\pi\eta\textit{a}}$, \textit{a} – радиус частицы, $\eta$ - коэффициент вязкости.

При описании броуновского движения частицы в одномерном случае можно считать, что на частицу действует сила случайная сила, среднее значение которой равно нулю $  \langle F_x \rangle $ = $\lim\limits_{t \to \infty} \{\frac{1}{t}\int_{0}^{t}F_x\mathrm{d}t\}$ = 0 и сила сопротивления $F_c$ = r$v_x$, где r - коэффициент вязкого трения броуновской частицы в жидкости.  Уравнение движения  \textit{m$a_x$} = $F_x$ - $F_c$ при подстановке выражение для силы примет вид

\begin{equation}
	m\ddot{x} + r\dot{x} = F_x
\end{equation}

Умножим это урвнение на $x$ и используем равенство  $x$$\ddot{x}$ = $\frac{\mathrm{d}(x\dot{x})}{\mathrm{d}t}$ - $\dot{x}^2$

\begin{equation}
	m\frac{\mathrm{d}(x\dot{x})}{\mathrm{d}t} - m\dot{x}^2 + rx\dot{x} = xF_x
\end{equation}

Проведем усреднение по времени 

\begin{equation}
	m\langle \frac{\mathrm{d}(x\dot{x})}{\mathrm{d}t} \rangle - m\langle \dot{x}^2 \rangle + r\langle x\dot{x} \rangle = \langle xF_x \rangle
\end{equation}

Тогда $\langle$ x$F_x$ $\rangle$ = $\lim\limits_{t \to \infty} \{\frac{1}{t}\int_{0}^{t}xF_x\mathrm{d}t\}$ = $\lim\limits_{t \to \infty} \{x\frac{1}{t}\int_{0}^{t}F_x\mathrm{d}t-\frac{1}{t}\int_{0}^{t}(\int_{0}^{t}F_x\mathrm{d}t)\dot{x}\mathrm{d}t\}$ = 0. Для одномерного движения по теореме о распределении энергии по степеням свободы $\frac{m\langle \dot{x}^2 \rangle}{2} =\frac{kT}{2} $

Заменяем $\langle$ $\frac{\mathrm{d}(x\dot{x})}{\mathrm{d}t}$ $\rangle$ = $\frac{\mathrm{d}\langle x\dot{x} \rangle}{\mathrm{d}t}$ и получаем уравнение m$\frac{\mathrm{d}\langle x\dot{x} \rangle}{\mathrm{d}t}$ + r$\langle$ x$\dot{x}$ $\rangle$ = kT, откуда

\begin{equation}
	\langle x\dot{x} \rangle = \frac{kT}{r}(1 - e^{-\frac{m}{r}t})
\end{equation}

Для установившегося движения $\langle$ \textit{x}$\dot{x}$ $\rangle$ = $\frac{kT}{r}$. Так как x$\dot{x}$ = $\frac{1}{2}$ $\frac{\mathrm{d}(x^2)}{\mathrm{d}t}$, то $\frac{\mathrm{d}\langle x^2 \rangle}{\mathrm{d}t}$ = $\frac{kT}{r}$. После интеграрирования по времени получаем $\langle$ $x^2$ $\rangle$ = 2$\frac{kT}{r}t$. Для сферической броуновской частицы, радиус которой равен \textit{a}: \textit{r} = 6$\pi$$\eta$\textit{a}, поэтому D = $\frac{\textit{k}T}{6\pi\eta\textit{a}}$.

Полученные выше формулы были экспериментально проверены в 1908 году Перреном, который измерял с помощью микроскопа перемещения броуновских частиц за одинаковые промежутки времени. Ему удалось на основании своих опытов с помощью этих формул определить постоянную Больцмана \textit{k} и вычислить значение постоянной Авогадро $N_A$, совпадающие по величине с их значениями, полученными другими методами.

\section{Моделирование броуновского движения}

\subsection{Классическое броуновское движение}

Рассмотрим случайный процесс (случайную величину) \textit{X(t)}, заданную на отрезке [0,\textit{T}].

\textit{Случайный процесс}  \textit{X(t)} называется одномерным броуновским движением (или винеровским процессом) на интервале [0,\textit{T}], если он обладает следущими свойствами:
\begin{itemize} 
\item \textit{X}(0) = 0 почти наверное и \textit{X(t)} - почти наверное непрерывная функция на [0,\textit{T}]
\item \textit{X(t)} - процесс с независимыми приращениями
\item  \textit{X(t)} -  процесс с приращениями, распределёнными нормально.
\end{itemize}

Отметим следующие свойства броуновского движения:
\begin{itemize} 
	\item \textit{X(t)} почти наверное нигде не дифференцируем 
	\item  \textit{X(t)} - марковский процесс (не обладает памятью), т.е. если известна величина \textit{X(t)}, то при $t_1$ < $t$ < $t_2$ величины \textit{X($t_1$)} и \textit{X($t_2$)} независимы.
	\item Фрактальная размерность графика \textit{X(t)} равна 1.5
	\item Приращение \textit{X(t)} обладает свойством статистического самоподобия: для любого $r$ > 0
	\begin{equation}
		X(t+ \bigtriangleup t) = \frac{1}{\sqrt{r}}(X(t+r\bigtriangleup t) - X(t))
	\end{equation}
	\item Стационарность приращений: дисперсия приращения зависит только от разности моментов времени
	\begin{equation} \label{1.6}
		D(X(t_2) - X(t_1)) = \sigma^2|t_2-t_1|
	\end{equation}
	\item Математическое ожидание приращения равно
	\begin{equation}
	E(|X(t_2) - X(t_1)|) = \sqrt{\frac{2}{\pi}}\sigma\sqrt{|t_2-t_1|}
	\end{equation}
\end{itemize}

Для моделрования броуновского движения можно воспользоваться разными алгоритмами. Рассмотрим 3 из них.

Проще всего реализовать дискретную реализацию броуновского движения, рассмотрев последовательность $x_0$ = 0, $x_{n+1} = x_n + g_n$, где $g_n$ - случайная величина, имеющая нормальное распределение (например, $N(0,1)$).

\begin{algorithmic}[1]
	\State $array[N]$
	\State $array[0]\gets 0$
	\For{i = 1,..., $N$}
	\State $array[i+1]\gets array[i] + randomNormal(0,1)$
	\EndFor
\end{algorithmic}

\subsection{Алгоритм срединных смещений}

Метод случайного срединного смещения основан на работах Н.Виннера , он более сложен, чем метод из предыдущего параграфа, однако используется для конструктивного доказательства существования броуновского движения, а также для построения фрактальной интерполяции (когда необходимо чтобы кривая проходила через заданные точки интерполяции). Метод также может быть обобщен на случай $n$-мерных броуновских движений.

Алгоритм случайного срединного смещения вычисляет значения $X(t)$ в диадических рациональных точках вида $\frac{k}{2^n}$ $\in$ [0,1]. Последовательно вычисляются значения в середине отрезка [0,1], а затем в серединах отрезков [0, $\frac{1}{2}$] и [$\frac{1}{2}, 1$] и т.д. На каждом шаге итерации должен выполнятьяс закон дисперсии для приращения (\ref{1.6}) в вычисленных точках. Параметр $\sigma$ определяет масщтаб по вертикальной оси, не влияя на фрактальную размерность графика. 

\subsubsection{Броуновское движение методом срединнго смещения (1)}
Вход: $N$, 	$\sigma$ // $N$ - число шагов алгоритма, при этом всего $2^N + 1$ точек интерполяции, $\sigma$ - параметр вертикального масштаба, коэффициент дисперсии
 
Выход: массив значений $\left\{X(\frac{k}{2^N})\right\}_{k=0}^{2^N}$ // реализация броуновского движения $X(t)$ на дискретном множестве точек вида $t_k = \frac{k}{2^N}$, k $\in$ $[0, 2^N]$

\begin{algorithmic}[1]
	\State $X(0)\gets 0$
	\State $X(1)\gets \sigma g$ // g - случайная величина, распределенная нормально с параметрами $N(0,1)$
	\State $X(\frac{1}{2})\gets$ $\frac{1}{2}$(X(0) + X(1)) +$\frac{1}{2}$$\sigma$g
	\State $X(\frac{1}{4})\gets$ $\frac{1}{2}$(X(0) + X($\frac{1}{2}$)) + $\frac{1}{2^{\frac{3}{2}}}$$\sigma$g
	\State $X(\frac{3}{4})\gets$ $\frac{1}{2}$(X($\frac{1}{2}$) + X(1)) + $\frac{1}{2^{\frac{3}{2}}}$$\sigma$g
	\Statex
	...
	\State $X(\frac{1}{2^N})\gets$ $\frac{1}{2}$ (X(0) + X($\frac{1}{2^{N - 1}}$)) + $\frac{1}{2^{(N + 1) / 2}}$$\sigma$g
	\Statex
	...
	\State $X(\frac{2^N - 1}{2^N})\gets$  $\frac{1}{2}$ (X($\frac{2^{N - 1} - 1}{2^{N - 1}}$) + X(1)) + $\frac{1}{2^{(N + 1) / 2}}$$\sigma$g
\end{algorithmic}
	
	Заметим, что точки $t_k$ можно последовательно занумеровать номерами $k$. При этом если точка имеет вид $\frac{a}{2^b}$, то ее номер $k = a2^{N-b}$. Укажем алгорит, в котором точки $t_k$ пронумерованы эфективно.
	
\subsubsection{Броуновское движение методом срединнго смещения (2)}

Вход: $N$, 	$\sigma$ // $N$ - число шагов алгоритма, при этом всего $2^N + 1$ точек интерполяции, $\sigma$ - параметр вертикального масштаба, коэффициент дисперсии

Выход: массив значений $\left\{X(\frac{k}{2^N})\right\}_{k=0}^{2^N}$ // реализация броуновского движения $X(t)$ на дискретном множестве точек вида $t_k = \frac{k}{2^N}$, k $\in$ $[0, 2^N]$

\begin{algorithmic}[1]
	\State $X(0)\gets 0$
	\State $X(1)\gets \sigma g$ // g - случайная величина, распределенная нормально с параметрами $N(0,1)$
	\For{j = 1,..., N}
		\For{i = 1,..., $2^{N-1}$}
		\State $X((2i - 1) 2^{N - j})$$\gets$ $X((i - 1)2^{N-j+1}) + X(i2^{N - j + 1}) + \frac{1}{2^{(j+1)/2}}$$\sigma$ g
		\EndFor
	\EndFor
\end{algorithmic}

\subsection{Фрактальное броуновское движение}

Фрактальное броуновское движение (ФБД) уже не является марковским процессом, а обладает некорой "памятью". Кроме того, вводя параметр $0 < H < 1$ можно получитьодномерное ФБД размерности $d = 2 - H$ и двумерное ФБД размерности $d = 3 - H$ .
Заметим, что классическое броуновское движение получается как частный случай при $H = 0.5$. Для апроксимации ФБД нет простого метода, вроде суммирования нормальных случайных величин, как в случае классического броуновского движения. Для апроксимации ФБД наиболее удобно использовать преобразования Фурье.

Рассмотрим случайный процесс (случайную величину) $X(t)$, заданную на отрезке $[0, T]$.

\textit{Случайный процесс}  $X(t)$ называется одномерным фрактальным броуновским движением на интервале $[0, T]$, если он обладает следущими свойствами:

\begin{itemize}
	\item $X(0) = 0$ почти наверное и $X(t)$ - почти наверне непрерывная функция на $[0, T]$
	\item  $X(t)$ - процесс с приращениями, распределенными нормально
\end{itemize}

Отметим следующие свойства фрактального броуновского движения:

\begin{itemize}
	\item $X(t)$ почти наверное нигде не дифференцируем 
	\item Фрактальная размерность графика $X(t)$ равна $2 - H$
	\item Процесс $x(t)$ не обладает свойством независимости приращений
	\item Приращение \textit{X(t)} обладает свойством статистического самоподобия: для любого $r$ > 0
	\begin{equation}
		X(t+ \bigtriangleup t) = \frac{1}{\sqrt{r}}(X(t+r\bigtriangleup t) - X(t))
	\end{equation}
	\item Стационарность приращений: дисперсия приращения зависит только от разности моментов времени
	\begin{equation} \label{1.6}
		D(X(t_2) - X(t_1)) = \sigma^2|t_2-t_1|^{2H}
	\end{equation}
	\item Математическое ожидание приращения равно
	\begin{equation}
		E(|X(t_2) - X(t_1)|) = \sqrt{\frac{2}{\pi}}\sigma|t_2-t_1|^H
	\end{equation}
\end{itemize}

\subsubsection{Метод Фурье-фильтрации для построения ФБД}

\newtheorem{theorem1}{Теорема}
\begin{theorem1}
	Если $X(t)$ - ФБД с параметром $H$, то его спектральная плотность 
	\begin{equation}
		S(f) \propto \frac{1}{f^{2H+1}}
	\end{equation}
\end{theorem1}

Идея метода состоит в следующем. Строится преобразование Фурье для искомого ФБД в частной области, задавая случайные фазы и подбирая амплитуды, удовлетворяющие свойству из Теоремы 1. Затем получаем ФБД во временной области с помощью обратного преобразования Фурье.

Будем моделировать дискретный аналог ФБД, то есть наша цель- получить величины $\left\{X_n\right\}_{n=0}^{N-1}$, апроксимирующиеФБД в точках $n$. Воспользуемся формулой дискретного преобразования Фурье

\begin{equation}
	\hat{X_n} = \sum_{k=0}^{N-1}X_ke^{-2\pi kn/N}
\end{equation}

и обратного дискретного преобразования Фурье

\begin{equation}
	X_n = \sum_{k=0}^{N-1}\hat{X_k}e^{2\pi kn/N}
\end{equation}

Далее будем рассматривать только четные значения $N$, а для применения метода \textit{быстрого дискретного преобразования Фурье} нужно, чтобы $N=2^M$, $M \in \mathbb{N}$. Метод быстрого дискретного преобразования Фурье  реализован во многих системах компьютерной алгебры. Он позволяет сократить вычисления в $\frac{2N}{\log_2N}$ раз.

Для того, чтобы получающиеся величины $X_n$ были вещественными мы наложим условие сопряженной симметрии:

\begin{equation}
	\hat{X}_0, \hat{X}_{N/2} \in \mathbb{R}, \hat{X}_n = \hat{X}_{N-n}, n = 1,...,N/2-1
\end{equation}

Фильтрация относится к той части моделирования, когда мы заставляем коэффициенты преобразования Фурье удовлетворять степенному закону из Теоремы 1:

\begin{equation}
	|\hat{X}_n|^2 \propto \frac{1}{n^{2H+1}}, n = 1,...,N/2
\end{equation}

Для этого возьмем

\begin{equation}
	\hat{X}_n = \frac{ge^{2\pi iu}}{n^{H+0.5}}
\end{equation}

где $g$ - независимые значения нормально распределенной случайной величины с параметрами $N(0,1)$, а $u$ - независимые значения равномерно распределенной на отрезке [0,1] случайной величины. Оставшиеся коэффициенты вечислим из сотношений 1.15.

Для вычисления искомой аппроксимации ФБД $\left\{X_n\right\}_{n=0}^{N-1}$ применим обратное дискретное преобразование Фурье к набору $\left\{\hat{X}_n\right\}_{n=0}^{N-1}$.

\subsubsection{Кривая ФБД методом Фурье-фильтрации}

Вход: $H \in (0,1)$, $N=2^M$, $M \in \mathbb{N}$ // $H$ - параметр ФБД, размерность графика равна $d = 2 - H$, $N$ - параметр, определяющий количество точек дискретизации ФБД.

Выход: массив значений $\left\{X_n\right\}_{n=0}^{N-1}$ // дискретная апроксимация ФБД в последовательные моменты времени n.

\begin{algorithmic}[1]
	\State $\hat{X}_0\gets g$
	\For{j = 1,..., N/2-1}
	\State $\hat{X}_j \gets \frac{ge^{2\pi iu}}{j^{H+0.5}}$
	\EndFor
	\State $\hat{X}_{N/2} \gets \frac{g\cos(2\pi iu)}{(N/2)^{H+0.5}}$ // Здесь $\cos$ — вещественная часть комплексной экспоненты $e$
	\For{j = N/2+1,..., N-1}
	\State $\hat{X}_j \gets \overline{\hat{X}_{N-j}}$
	\EndFor
	\State $X \gets convert(\hat{X})$ // Вектор $X = \left\{X_0,...,X_{N-1}\right\}$ получается обратным дискретным преобразованием Фурье из вектора $\hat{X} = \left\{\hat{X}_0,...,\hat{X}_{N-1}\right\}$.
\end{algorithmic}

Для построения апроксимации двумерного фрактального броуновского движения методом Фурье-фильтрации используются те же идеи, что и в одномерном случае. Вместо $\hat{X}_n$ используется $\hat{X}_{k,j}$, $k,j = \overline{0,N-1}$, условие Теоремы 1 примет вид:

\begin{equation}
	|\hat{X}_{k,j}|^2 \propto \frac{1}{(k^2+j^2)^{H+1}}, n,k= 1,...,N/2
\end{equation}

мы возьмем

\begin{equation}
	\hat{X}_{k,j} = \frac{ge^{2\pi iu}}{(k^2+j^2)^{H/2+0.5}}, n,k= 1,...,N/2
\end{equation}

Запишем обратное дискретное преобразование Фурье: для $m,n=\overline{0,N-1}$

\begin{gather}
	\begin{split}
		\hat{X}_{m,n} = \sum_{k=0}^{N-1}\sum_{j=0}^{N-1}\hat{X}_{k,j}e^{-2\pi i \frac{kn+jm}{N}} = \hat{X}_{0,0} + \sum_{k=1}^{N-1}\hat{X}_{k,0}e^{-2\pi i\frac{kn}{N}} + \sum_{j+1}^{N-1}\hat{X}_{0,j}e^{-2\pi i \frac{jm}{N}} + \\
		\sum_{k=1}^{N/2}\sum_{j=1}^{N/2}\hat{X}_{k,j}e^{-2\pi i \frac{kn+jm}{N}} + \sum_{k=\frac{N}{2}+1}^{N-1} \sum_{j=\frac{N}{2}+1}^{N-1}(...) + \sum_{k=1}^{N/2}\sum_{j=\frac{N}{2}+1}^{N-1}(...) + \sum_{k=\frac{N}{2}+1}^{N-1} \sum_{j=1}^{N/2}(...)
	\end{split}
\end{gather}

Из формулы (1.19) следует, что для вещественности всех величин $X_{m,n}$ достаточно выполнения следующих условий сопряженной симметрии:

\begin{align}
		\hat{X}_{N-k,N-j} &= \overline{\hat{X}_{k,j}} &k,j &= \overline{1,N/2} &\hat{X}_{N/2,N/2} & \in \mathbb{R}\\
		\hat{X}_{k,N-j} &= \overline{\hat{X}_{N-k,j}} &k,j &= \overline{1,N/2-1} &\hat{X}_{0,0} & \in \mathbb{R}\\
		\hat{X}_{0,N-j} &= \overline{\hat{X}_{0,j}} &j &= \overline{1,N/2} &\hat{X}_{0,N/2} & \in \mathbb{R}\\
		\hat{X}_{N-k,0} &= \overline{\hat{X}_{k,0}} &k &= \overline{1,N/2} &\hat{X}_{N/2,0} & \in \mathbb{R}
\end{align}

Условия (1.22)-(1.23) обеспечивают вещественность первых двух сумм, а условия (1.20)-(1.21) - оставшихся четырех сумм.

\subsubsection{Поверхность ФБД методом Фурье-фильтрации}

Вход: $H \in (0,1)$, $N=2^M$, $M \in \mathbb{N}$ // $H$ - параметр ФБД, размерность графика равна $d = 3 - H$, $N$ - параметр, определяющий количество точек ФБД по каждому из двух измерений.

Выход: массив значений $\left\{X_{n,k}\right\}_{n,k=0}^{N-1}$ // дискретная апроксимация ФБД на решетке узлов.

\begin{algorithmic}[1]
	\For{$j,k = 1,..., N/2$}
	\State $\hat{X}_{j,k} \gets \frac{ge^{2\pi iu}}{(j^2+k^2)^{H/2+0.5}}$
	\State$\hat{X}_{N-j,N-k} \gets \overline{\hat{X}_{j,k}}$
	\EndFor
	
	\For{$k = 1,..., N/2-1$}
	\State $\hat{X}_{0,k} \gets \frac{ge^{2\pi iu}}{(k^2)^{H/2+0.5}}$
	\State $\hat{X}_{k,0} \gets \frac{ge^{2\pi iu}}{(k^2)^{H/2+0.5}}$
	\State $\hat{X}_{0,N-k} \gets \overline{\hat{X}_{0,k}}$
	\State $\hat{X}_{N-k,0} \gets \overline{\hat{X}_{k,0}}$
	\EndFor
	
	\For{$j,k = 1,..., N/2-1$}
	\State $\hat{X}_{N-j,k} \gets \frac{ge^{2\pi iu}}{((N-j)^2+k^2)^{H/2+0.5}}$
	\State $\hat{X}_{j,N-k} \gets \overline{\hat{X}_{N-j,k}}$
	\EndFor
	
	\State $\hat{X}_{0,0} \gets 0$
	\State $\hat{X}_{N/2,0} \gets \frac{g\cos (2\pi u)}{((N/2)^2)^{H/2+0.5}}$
	\State $\hat{X}_{0,N/2} \gets \frac{g\cos (2\pi u)}{((N/2)^2)^{H/2+0.5}}$
	\State $\hat{X}_{N/2,N/2} \gets \frac{g\cos (2\pi u)}{(2(N/2)^2)^{H/2+0.5}}$
	
	\State $X \gets convert(\hat{X})$ // Обратное дискретное преобразование Фурье матрицы $\hat{X} = \left\{X_{j,k}\right\}_{j,k=0}^{N-1}$.
\end{algorithmic}

\subsection*{Вывод}

Наиболее реалистично изобразить броуновское движение позволяет алгоритм Фурье-фильтрации. Однако он содержит большое количество сложных вычеслений, которые отрицательно влияют на скорость работы программы. Поэтому для реализации отрисовки броуновского движения будет использован метод срединного смещения. Данный метод легко обобщается для случая $n$-мерных броуновских движений, а также требует более простых вычислений.

\newpage

\section{Формализация модели}
Модель броуновского движения частиц будет задаваться такими характеристиками, как:
\begin{itemize} 
    \item размер частиц -- число типа $int$;
    \item скорость распространения -- маляа, средняя или высокая;
    \item количество частиц -- число типа $int$.
\end{itemize}

Также частью на сцене будет изображено помещение. Пользователь должен уметь задавать материал покрытия стен:
\begin{itemize} 
	\item дерево;
	\item бумага (обои).
\end{itemize}
 и пола:
\begin{itemize} 
	\item дерево (паркет);
	\item керамика (плитка).
\end{itemize}


\section{Выбор программного обеспечения}

Рендеринг или отрисовка -- термин в компьютерной графике, обозначающий процесс получения изображения по модели с помощью компьютерной программы.

В языке Java есть несколько основных инструментов для создания пользовательских изображений. Самыми популярными из них являются JavaFX и Swing.

\subsection{Swing}

\textbf{Swing} -- библиотека для создания графического интерфейса для программ на языке Java. Swing был разработан компанией SunMicrosystems. Он содержит ряд графических компонентов, таких как кнопки, поля ввода, таблицы и т. д.

\textbf{Преимущества:} 
\begin{itemize}
    \item Кроссплатформенность;
    \item Компоненты Swing следуют парадигме Model-View-Controller (MVC) и, таким образом, могут обеспечить гораздо более гибкий пользовательский интерфейс;
    \item Swing обеспечивает встроенную двойную буферизацию.
\end{itemize}

\textbf{Недостатки:} 
\begin{itemize}
	\item достаточно узкий спектр возможностей при работе с ui.
    \item считается устаревшей библиотекой.
\end{itemize}


\subsection{JavaFX}

\textbf{JavaFX} -- платформа на основе Java для создания приложений с насыщенным графическим интерфейсом. Может использоваться как для создания настольных приложений, запускаемых непосредственно из-под операционных систем, так и для интернет-приложений, работающих в браузерах, и для приложений на мобильных устройствах. 

JavaFX предназначен для предоставления приложениям таких сложных функций графического интерфейса, как плавная анимация, просмотр веб-страниц, воспроизведение аудио и видео, а также использование CSS стилей.

\textbf{Преимущества:} 
\begin{itemize}
	\item кроссплатформенность;
    \item больше встроенных возможностей;
    \item меньше кода.
\end{itemize}

\textbf{Недостатки:} 
\begin{itemize}
    \item технология еще молодая и "незрелая";
    \item в значительной степени зависит от огромной инфраструктуры, которая окружает Java.
\end{itemize}



\subsection*{Вывод}

Уже более 10 лет разработчики приложений считают Swing высокоэффективным инструментарием для создания графических пользовательских интерфейсов (GUI) и добавления интерактивности в Java-приложения. Однако некоторые из самых популярных на сегодняшний день функций графического интерфейса не могут быть легко реализованы с помощью Swing в отличии от JavaFX. 

Также можно писать программы на JavaFX, используя гораздо меньше кода, потому что JavaFX выполняет за нас всю работу. Не нужно регистрировать event listeners, и это делает тело функций более кратким. Кроме того, с помощью механизма привязки JavaFX легко интегрировать компоненты графического интерфейса с базовой моделью. Основываясь на вышесказанном в качестве библиотеки для работы с GUI была выбрана JavaFX.

\section*{Вывод}

В данном разделе были формально описаны все методы по визуализации броуновского движения, с помощью которых можно получить реализацию распространения частиц, а также техноогии работы с GUI. В качестве алгоритма визуализации броуновского дижения предпочтение отдается методу срединных смещений. Также JavaFX была выбрана в качестве библиотеки работы с GUI.

