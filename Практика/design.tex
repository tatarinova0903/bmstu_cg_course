\chapter{Конструкторская часть}

В данном разделе будут представлены требования к программному обеспечению, а также схемы алгоритмов, выбранных для решения задачи.

\section{Формализация модели}
Модель броуновского движения частиц будет задаваться такими характеристиками, как:
\begin{itemize} 
	\item размер частиц -- число типа $int$;
	\item скорость распространения -- маляа, средняя или высокая;
	\item количество частиц -- число типа $int$.
\end{itemize}

Также частью на сцене будет изображено помещение. Пользователь должен уметь задавать материал покрытия стен:
\begin{itemize} 
	\item дерево;
	\item бумага (обои).
\end{itemize}
и пола:
\begin{itemize} 
	\item дерево (паркет);
	\item керамика (плитка).
\end{itemize}

\section{Выбор программного обеспечения}

Рендеринг или отрисовка -- термин в компьютерной графике, обозначающий процесс получения изображения по модели с помощью компьютерной программы.

В языке Java есть несколько основных инструментов для создания пользовательских изображений. Самыми популярными из них являются JavaFX и Swing.

\subsection{Swing}

\textbf{Swing} -- библиотека для создания графического интерфейса для программ на языке Java. Swing был разработан компанией SunMicrosystems. Он содержит ряд графических компонентов, таких как кнопки, поля ввода, таблицы и т. д.

\textbf{Преимущества:} 
\begin{itemize}
	\item Кроссплатформенность;
	\item Компоненты Swing следуют парадигме Model-View-Controller (MVC) и, таким образом, могут обеспечить гораздо более гибкий пользовательский интерфейс;
	\item Swing обеспечивает встроенную двойную буферизацию.
\end{itemize}

\textbf{Недостатки:} 
\begin{itemize}
	\item достаточно узкий спектр возможностей при работе с ui.
	\item считается устаревшей библиотекой.
\end{itemize}


\subsection{JavaFX}

\textbf{JavaFX} -- платформа на основе Java для создания приложений с насыщенным графическим интерфейсом. Может использоваться как для создания настольных приложений, запускаемых непосредственно из-под операционных систем, так и для интернет-приложений, работающих в браузерах, и для приложений на мобильных устройствах. 

JavaFX предназначен для предоставления приложениям таких сложных функций графического интерфейса, как плавная анимация, просмотр веб-страниц, воспроизведение аудио и видео, а также использование CSS стилей.

\textbf{Преимущества:} 
\begin{itemize}
	\item кроссплатформенность;
	\item больше встроенных возможностей;
	\item меньше кода.
\end{itemize}

\textbf{Недостатки:} 
\begin{itemize}
	\item технология еще молодая и "незрелая";
	\item в значительной степени зависит от огромной инфраструктуры, которая окружает Java.
\end{itemize}



\subsection*{Вывод}

Уже более 10 лет разработчики приложений считают Swing высокоэффективным инструментарием для создания графических пользовательских интерфейсов (GUI) и добавления интерактивности в Java-приложения. Однако некоторые из самых популярных на сегодняшний день функций графического интерфейса не могут быть легко реализованы с помощью Swing в отличии от JavaFX. 

Также можно писать программы на JavaFX, используя гораздо меньше кода, потому что JavaFX выполняет за нас всю работу. Не нужно регистрировать event listeners, и это делает тело функций более кратким. Кроме того, с помощью механизма привязки JavaFX легко интегрировать компоненты графического интерфейса с базовой моделью. Основываясь на вышесказанном в качестве библиотеки для работы с GUI была выбрана JavaFX.


\section{Требования к программному обеспечению}

Программа должна предоставлять доступ к функционалу:

\begin{itemize}
    \item изменение параметров модели водопада в активном режиме: высота водопада, угол падения воды, скорость водяного потока;
    \item изменение параметров частиц, из которых состоит водопад, в активном режиме: количество частиц, размер частиц;
    \item включение и выключение работы модели водопада;
    \item вращение, перемещение и масштабирование модели.
\end{itemize}

Требования, которые предъявляются к программе:

\begin{itemize}
    \item время отклика программы должно быть менее 1 секунды для корректной работы в интерактивном режиме;
    \item программа должна корректно реагировать на любое действие пользователя.
\end{itemize}


\section{Разработка алгоритмов}

В данном разделе будут представлены схемы реализации выбранных алгоритмов.

\subsection{Система частиц для реализации водопада}

На рисунке \ref{img:waterfall_scheme.png} показана схема алгоритма реализации движения частицы и возможные этапы ее превращения в пар и брызг.

\imgHeight{200mm}{waterfall_scheme.png}{Схема алгоритма движения частицы водопада}


\subsection{Отрисовка изображения}

На рисунке \ref{img:draw_dynamic.png} показана схема алгоритма отрисовки части сцены, отвечающей за водопад, а на рисунке \ref{img:draw_solid.png} -- схема алгоритма для отрисовки остальных объектов сцены (скалы и водного полотна).

\imgHeight{200mm}{draw_dynamic.png}{Схема алгоритма отрисовки водопада}
\imgHeight{200mm}{draw_solid.png}{Схема алгоритма отрисовки статичного объекта (скалы)}

\clearpage


\section{Описание структуры программы}

На рисунке \ref{img:classes_scheme.png} показана структура реализуемых классов.

\imgHeight{100mm}{classes_scheme.png}{Схема классов программы}

\clearpage

Описание реализуемых классов:

\begin{itemize}
    \item \textbf{Camera} -- класс для работы с камерой. Хранит позицию камеры, угол ее наклона, скорость перемещения для динамической смены положения камеры;
    \item \textbf{Shader} -- класс, который подключает шейдеры к приложению. Хранит данные шейдеров для передачи цвета объектов;
    \item \textbf{Object} -- класс, который владеет информацией о всех объектах сцены;
    \item \textbf{winGL} -- класс для отрисовки объектов сцены. Хранит массив частиц для водопада, хранит массив цветов для водопада, а также данные для отрисовки статичных объектов;
    \item \textbf{Particle} -- класс, который описывает одну частицу водопада. Хранит ее положение, направление движения, цвет, скорость, время жизни и максимальное время жизни. 
\end{itemize}


\section{Используемые типы и структуры данных}

При реализации программного обеспечения были использованы следующие типы и структуры данных:

\begin{itemize}
    \item параметры водопада: высота, ширина, скорость, размер частиц -- числа типа $float$;
    \item параметры водопада: количество частиц -- число типа $int$
    \item точка -- массив координат по осям X, Y, Z;
    \item объект -- массив точек с координатами вершин, также массив связей между номерами вершин;
    \item водопад -- массив частиц (объектов класса $Particle$).
\end{itemize}


\section*{Вывод}

В данном разделе были рассмотрены требования, которые выдвигаются программному продукту, схемы алгоритмов, а также типы и структуры данных, которые были использованы при реализации ПО. 
